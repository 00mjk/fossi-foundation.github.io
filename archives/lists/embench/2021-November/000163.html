<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Embench] WD Code size compiler tests
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:embench%40lists.librecores.org?Subject=Re%3A%20%5BEmbench%5D%20WD%20Code%20size%20compiler%20tests&In-Reply-To=%3CCO6PR04MB770066DAB072D101040034A3EA999%40CO6PR04MB7700.namprd04.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="000161.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Embench] WD Code size compiler tests</H1>
    <B>Nidal Faour</B> 
    <A HREF="mailto:embench%40lists.librecores.org?Subject=Re%3A%20%5BEmbench%5D%20WD%20Code%20size%20compiler%20tests&In-Reply-To=%3CCO6PR04MB770066DAB072D101040034A3EA999%40CO6PR04MB7700.namprd04.prod.outlook.com%3E"
       TITLE="[Embench] WD Code size compiler tests">Nidal.Faour at wdc.com
       </A><BR>
    <I>Tue Nov 16 12:40:19 CET 2021</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="000161.html">[Embench] Adding WD compiler test-cases to Embench
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#163">[ date ]</a>
              <a href="thread.html#163">[ thread ]</a>
              <a href="subject.html#163">[ subject ]</a>
              <a href="author.html#163">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi All,
A while ago we started this thread and I mistakenly replied to Roger only, so there is the reply:

&quot;&quot;&quot;
I agree with what you suggested, these four bullets must be sorted out.
As for the “maturity”, I think it was a misleading word. What I meant is looking at code that the compiler could have made it better in the matter of code size. of course, you need someone to investigate the generated assembly and eliminate the parts where it is an ISA limitation.
As for the audience, I think we should target developers at first who want to improve tools/compilers, for the same reason I mentioned about ISA limitation, at least until we can come up with fully automated measurements.
How do you think we should proceed from here? 
&quot;&quot;&quot;

Following the meeting yesterday, we will prepare a document to better describe the purpose of the test, how did we come up with these tests, and how to use them.
We will also define the way to add more tests to the repo. And what it should contain.

Waiting for your feedback/suggestion on this matter.

Best Regards,

Nidal Faour
Staff Engineer, R&amp;D Engineering – Firmware &amp; Toolchain, CTO Group

Western Digital®
Migdal Tefen 24959, P.O Box 3
Email: <A HREF="https://lists.librecores.org/listinfo/embench">nidal.faour at wdc.com</A>
Office: +972-4-9078756
Mobile: +972-50-8867756

&gt;<i>-----Original Message-----
</I>&gt;<i>From: Embench &lt;<A HREF="https://lists.librecores.org/listinfo/embench">embench-bounces at lists.librecores.org</A>&gt; On Behalf Of
</I>&gt;<i><A HREF="https://lists.librecores.org/listinfo/embench">embench-request at lists.librecores.org</A>
</I>&gt;<i>Sent: Friday, 14 May 2021 13:40
</I>&gt;<i>To: <A HREF="https://lists.librecores.org/listinfo/embench">embench at lists.librecores.org</A>
</I>&gt;<i>Subject: Embench Digest, Vol 22, Issue 5
</I>&gt;<i>
</I>&gt;<i>CAUTION: This email originated from outside of Western Digital. Do not click
</I>&gt;<i>on links or open attachments unless you recognize the sender and know that
</I>&gt;<i>the content is safe.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Send Embench mailing list submissions to
</I>&gt;<i>        <A HREF="https://lists.librecores.org/listinfo/embench">embench at lists.librecores.org</A>
</I>&gt;<i>
</I>&gt;<i>To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i>        <A HREF="https://lists.librecores.org/listinfo/embench">https://lists.librecores.org/listinfo/embench</A>
</I>&gt;<i>or, via email, send a message with subject or body 'help' to
</I>&gt;<i>        <A HREF="https://lists.librecores.org/listinfo/embench">embench-request at lists.librecores.org</A>
</I>&gt;<i>
</I>&gt;<i>You can reach the person managing the list at
</I>&gt;<i>        <A HREF="https://lists.librecores.org/listinfo/embench">embench-owner at lists.librecores.org</A>
</I>&gt;<i>
</I>&gt;<i>When replying, please edit your Subject line so it is more specific than &quot;Re:
</I>&gt;<i>Contents of Embench digest...&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Today's Topics:
</I>&gt;<i>
</I>&gt;<i>   1. Re: WD Code size compiler tests (Roger Shepherd)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>Message: 1
</I>&gt;<i>Date: Fri, 14 May 2021 11:39:29 +0100
</I>&gt;<i>From: Roger Shepherd &lt;<A HREF="https://lists.librecores.org/listinfo/embench">roger.shepherd at chipless.eu</A>&gt;
</I>&gt;<i>To: <A HREF="https://lists.librecores.org/listinfo/embench">embench at lists.librecores.org</A>
</I>&gt;<i>Subject: Re: [Embench] WD Code size compiler tests
</I>&gt;<i>Message-ID: &lt;<A HREF="https://lists.librecores.org/listinfo/embench">56EBE553-056C-4AEE-80D7-269757955E59 at chipless.eu</A>&gt;
</I>&gt;<i>Content-Type: text/plain; charset=&quot;utf-8&quot;
</I>&gt;<i>
</I>&gt;<i>I replied directly to Nidal about this which was probably not the right way to
</I>&gt;<i>have done things. Prompted by Jeremy’s response, I’ll copy what I said to
</I>&gt;<i>Nidal here. I’ll leave it to Nidal to add his response.
</I>&gt;<i>
</I>&gt;<i>Nidal,
</I>&gt;<i>
</I>&gt;<i>I’ve had a look carefully at a couple of the benchmarks and I think they give
</I>&gt;<i>me a feel for what’s been done. I do like the idea of having a set of Embench
</I>&gt;<i>compiler tests and these could be a good starting point. Before we put too
</I>&gt;<i>much effort into setting things up, I think we need to try agree a set of
</I>&gt;<i>achievable and useful objectives. I think we need to cover
</I>&gt;<i>
</I>&gt;<i>1. Audience/Users
</I>&gt;<i>
</I>&gt;<i>2. Specific aspects of compiler that we’re trying to assess
</I>&gt;<i>
</I>&gt;<i>3. Assessment methodology
</I>&gt;<i>
</I>&gt;<i>4. Anything else
</I>&gt;<i>
</I>&gt;<i>To get things going, let me make some suggestions - if only that we can have
</I>&gt;<i>something concrete to disagree with!
</I>&gt;<i>
</I>&gt;<i>1. People wanting to assess compiler maturity. This includes compiler
</I>&gt;<i>developers and users.
</I>&gt;<i>
</I>&gt;<i>2. A set of particular scenarios where compilers in the past have shown a lack
</I>&gt;<i>of specific optimisations
</I>&gt;<i>
</I>&gt;<i>3. Compilation of source source code. An automated measurement of the
</I>&gt;<i>quality of the benchmark; perhaps size is good enough.
</I>&gt;<i>
</I>&gt;<i>It’s not clear that “size” provides a useful metric for comparing maturity
</I>&gt;<i>between architectures or between different abi’s on the same architecture. I
</I>&gt;<i>suspect that if undertaking this work personally, I’d probably eyeball the code
</I>&gt;<i>to see what was going on and not rely on any automated measurement, but I
</I>&gt;<i>think for Embench we should do better than that.
</I>&gt;<i>
</I>&gt;<i>4. There must be a check that the code will execute as expected.
</I>&gt;<i>
</I>&gt;<i>I don’t trust code that doesn’t execute. But making code executable has it’s
</I>&gt;<i>own problems - in particular, the extra code needed may make it difficult to
</I>&gt;<i>see what is happening regarding the particular optimisation that is being
</I>&gt;<i>checked for.
</I>&gt;<i>
</I>&gt;<i>Before we get too dragged into the details of 3 and 4 I do think we need to
</I>&gt;<i>check that we have 1, the audience, sorted out. We have a different task on
</I>&gt;<i>our hands if we are looking at providing a set of microbenchmarks for
</I>&gt;<i>architects and tool developers, or if we are trying benchmarks to help to
</I>&gt;<i>select cores and tools.
</I>&gt;<i>
</I>&gt;<i>Roger
</I>&gt;<i>
</I>&gt;<i>In the light of this my response to Jeremy’s mail is:
</I>&gt;<i>
</I>&gt;&gt;<i> On 02/05/2021 11:57, Nidal Faour wrote:
</I>&gt;&gt;&gt;<i> Hi all,
</I>&gt;&gt;&gt;<i> I would like to have your opinion about opening a new repo under the
</I>&gt;&gt;&gt;<i> Embench to hold the test cases done by WD. (located at the following
</I>&gt;&gt;&gt;<i> link)
</I>&gt;&gt;&gt;<i> <A HREF="https://github.com/westerndigitalcorporation/riscv32-Code-density-tes">https://github.com/westerndigitalcorporation/riscv32-Code-density-tes</A>
</I>&gt;&gt;&gt;<i> t-bench
</I>&gt;&gt;&gt;<i> &lt;<A HREF="https://github.com/westerndigitalcorporation/riscv32-Code-density-te">https://github.com/westerndigitalcorporation/riscv32-Code-density-te</A>
</I>&gt;&gt;&gt;<i> st-bench&gt;Hi Nidal,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm up for this. I think we need to get buy in from the Embench community.
</I>&gt;<i>What do others think?
</I>&gt;&gt;<i>
</I>&gt;<i>It needs buy-in and commitment. That means some people need to commit
</I>&gt;<i>to working on it, rather than just agreeing it is a good thing.
</I>&gt;<i>
</I>&gt;&gt;&gt;<i> My suggestion is to have a new repo to hold these tests and labeled
</I>&gt;<i>“compiler benchmark” or whatever better name you may suggest.
</I>&gt;&gt;<i> That would be the thing to do. We'd need to make sure it was consistent
</I>&gt;<i>with the 7 principles behind Embench. One that springs to mind is the need to
</I>&gt;<i>make sure that the benchmarks are self-verifying.
</I>&gt;<i>
</I>&gt;<i>Yes, but… see my (second) point 4 above. I think the tests are probably useful
</I>&gt;<i>even if they aren’t benchmarks as such (e.g. “here are some useful code
</I>&gt;<i>fragments to use to assess compiler maturity/code size”) but that might
</I>&gt;<i>beyond the scope of Embench. I this is also tied in with the questions of who
</I>&gt;<i>will use them? and what will they use them for.
</I>&gt;<i>
</I>&gt;&gt;&gt;<i> Also, I think it would be better to add a new column labeled “Compiler” to
</I>&gt;<i>the Embench Baseline Data slide to emphasize that these tests are made to
</I>&gt;<i>test the compiler maturity for the specific target.
</I>&gt;&gt;<i> Well they test three things - the processor, the compiler and the libraries.
</I>&gt;<i>There is always the issue of how much information to put on the summary.
</I>&gt;&gt;&gt;<i> Just to remind you, here is the Baseline Data table I’m referring to
</I>&gt;&gt;&gt;<i> as an example that I took from one of Jeremy's presentations. (see
</I>&gt;&gt;&gt;<i> the last column I’ve added)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Name
</I>&gt;&gt;&gt;<i> Comments
</I>&gt;&gt;&gt;<i> Orig Source
</I>&gt;&gt;&gt;<i> C LOC
</I>&gt;&gt;&gt;<i> code size
</I>&gt;&gt;&gt;<i> data size
</I>&gt;&gt;&gt;<i> time (ms)
</I>&gt;&gt;&gt;<i> branch
</I>&gt;&gt;&gt;<i> memory
</I>&gt;&gt;&gt;<i> compute
</I>&gt;&gt;&gt;<i> Compiler
</I>&gt;&gt;&gt;<i> aha-mont64
</I>&gt;&gt;&gt;<i> Montgomery multiplication
</I>&gt;&gt;&gt;<i> AHA
</I>&gt;&gt;&gt;<i> 162
</I>&gt;&gt;&gt;<i> 1,072
</I>&gt;&gt;&gt;<i> 0
</I>&gt;&gt;&gt;<i> 4,004
</I>&gt;&gt;&gt;<i> low
</I>&gt;&gt;&gt;<i> low
</I>&gt;&gt;&gt;<i> high
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> crc32
</I>&gt;&gt;&gt;<i> CRC error checking 32b
</I>&gt;&gt;&gt;<i> MiBench
</I>&gt;&gt;&gt;<i> 101
</I>&gt;&gt;&gt;<i> 284
</I>&gt;&gt;&gt;<i> 1,024
</I>&gt;&gt;&gt;<i> 4,010
</I>&gt;&gt;&gt;<i> high
</I>&gt;&gt;&gt;<i> med
</I>&gt;&gt;&gt;<i> low
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> cubic
</I>&gt;&gt;&gt;<i> Cubic root solver
</I>&gt;&gt;&gt;<i> MiBench
</I>&gt;&gt;&gt;<i> 125
</I>&gt;&gt;&gt;<i> 1,584
</I>&gt;&gt;&gt;<i> 0
</I>&gt;&gt;&gt;<i> 3,831
</I>&gt;&gt;&gt;<i> low
</I>&gt;&gt;&gt;<i> med
</I>&gt;&gt;&gt;<i> med
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i> I don't think the compiler alone adds much. What matters is all the
</I>&gt;<i>supplementary data (in the JSON file) providing all the details to reproduce
</I>&gt;<i>the results.
</I>&gt;&gt;<i>
</I>&gt;<i>Agreed that providing the information needed to enable reproducibility is key
</I>&gt;<i>for benchmarks.
</I>&gt;<i>
</I>&gt;<i>Roger
</I>&gt;<i>
</I>&gt;<i>-------------- next part --------------
</I>&gt;<i>An HTML attachment was scrubbed...
</I>&gt;<i>URL:
</I>&gt;<i>&lt;<A HREF="http://lists.librecores.org/pipermail/embench/attachments/20210514/761f7">http://lists.librecores.org/pipermail/embench/attachments/20210514/761f7</A>
</I>&gt;<i>b7f/attachment.htm&gt;
</I>&gt;<i>-------------- next part --------------
</I>&gt;<i>A non-text attachment was scrubbed...
</I>&gt;<i>Name: signature.asc
</I>&gt;<i>Type: application/pgp-signature
</I>&gt;<i>Size: 833 bytes
</I>&gt;<i>Desc: Message signed with OpenPGP
</I>&gt;<i>URL:
</I>&gt;<i>&lt;<A HREF="http://lists.librecores.org/pipermail/embench/attachments/20210514/761f7">http://lists.librecores.org/pipermail/embench/attachments/20210514/761f7</A>
</I>&gt;<i>b7f/attachment.sig&gt;
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>Subject: Digest Footer
</I>&gt;<i>
</I>&gt;<i>Embench mailing list
</I>&gt;<i><A HREF="https://lists.librecores.org/listinfo/embench">Embench at lists.librecores.org</A>
</I>&gt;<i><A HREF="https://lists.librecores.org/listinfo/embench">https://lists.librecores.org/listinfo/embench</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>------------------------------
</I>&gt;<i>
</I>&gt;<i>End of Embench Digest, Vol 22, Issue 5
</I>&gt;<i>**************************************
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="000161.html">[Embench] Adding WD compiler test-cases to Embench
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#163">[ date ]</a>
              <a href="thread.html#163">[ thread ]</a>
              <a href="subject.html#163">[ subject ]</a>
              <a href="author.html#163">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.librecores.org/listinfo/embench">More information about the Embench
mailing list</a><br>
</body></html>
